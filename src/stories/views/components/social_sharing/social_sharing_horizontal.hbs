{{~#with this.socialSharing ~}}
    <div x-data="stickySharingHandler"
        class="flex self-center justify-end ml-3 grow"
        x-intersect:leave="$store.sharingIsVisible=false"
        x-intersect:enter="$store.sharingIsVisible=true"
        x-on:resize.window="open=false"
        x-on:click.outside="close($refs.button)"
    >
        <div class="relative right-0 flex gap-3 p-1 bg-white md:h-auto"  >
            <button 
                class="{{#with ../this.trackingData}}js-load {{/with}}order-2 p-2 text-white border border-button bg-button ds-button font-heading hover:bg-button--dark hover:border-button--dark active:bg-button--dark group lg:hidden"
                x-ref="button"
                x-on:click="toggle()"
                :aria-expanded="open"
                :aria-controls="$id('dropdown-button')"
                
                {{#with ../this.trackingData}}
                    data-hr-click-tracking='{"settings": [{"type":"uxAction","secondLevelId": "{{this.secondLevelId}}","clickLabel": "socialShareClick::sharingmenuopened"}]}'
                {{/with}}
                
                >
                                {{> components/base/image/icon _addClass="w-5 h-5 fill-current group-hover:fill-link--dark" _icon="sharing" _iconmap="icons" }}
            </button>
            
            <div 
                x-ref="panel" 
                
                :class="open ? 'flex' : 'hidden '"
                    
               
                :id="$id('dropdown-button')"
                class="self-center bg-white h-8 absolute right-[50px] md:relative md:right-0 md:h-auto lg:flex"
            >
                <ul class="flex gap-3">  
                    {{> components/social_sharing/social_sharing_icons _socialSharingType="metadatabox"}}
                </ul>
            </div>
        </div>
    </div>
    <script>
        function stickySharingHandler(){
            return {
            open: false,
            sharingIsVisible: true,
            isDesktop: true,
            toggle() {
                var isMobileApple = navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)/i);
                var isMobileOther= navigator.userAgent.match(/(Android)|(webOS)|(Blackberry)|(Windows Phone)/i);
                var isMobile= isMobileApple || isMobileOther;
                if (navigator.share && isMobile) {
                    navigator.share({
                        title: document.title,
                        text: 'Schau mal was ich auf hessenschau.de gefunden habe!',
                        url: window.location.href,
                    })
                    .then(() => console.log('Shared successfully'))
                    .catch((error) => console.error('Sharing failed:', error));
                } else {
                    if (this.open) {
                        return this.close()
                    }
                    this.$refs.button.focus()
                    this.open = true
                    
                }
                
            },
            close(focusAfter) {
                if (! this.open) return
                this.open = false
                focusAfter && focusAfter.focus()
            }
        }
        }
    </script>
{{/with}}